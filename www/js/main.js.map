{"version":3,"sources":["terminal.js"],"names":["VidePlayer","frame","toggler","_this","this","arguments","length","undefined","_classCallCheck","play","startPlaying","cb","isState","isBusy","loaded","occupy","setState","player","playVideo","setTimeout","vacate","timeline","pause","pausePlaying","pauseVideo","busy","frameID","getAttribute","Error","state","notify","dataset","videoPlayerState","getState","_this2","YT","Player","events","onReady","ev","addEventListener","bind","onStateChange","data","PlayerState","PAUSED","ENDED","PLAYING","playerElements","document","getElementById","onYouTubeIframeAPIReady","load","querySelector","classList","remove","pairs","Array","from","querySelectorAll","map","togglees","JSON","parse","toggle","i","el","visible","forEach","_ref","preventDefault","instruction","prev","next","ModalWindow","Swiper","simulateTouch","observer","observeParents","navigation","prevEl","nextEl","element","lining","listener","_createClass","key","value","modalState","_this3","window","_this4","removeEventListener","id","modalToggler","modal","_ref2","open","liningListener","close","CubeImage","openTime","animationProcess","_this5","_this6","cubeEl","cube","getCubePosition","top","height","outTop","outBottom","innerHeight","changeCubeState","_cubeEl$getBoundingCl","getBoundingClientRect","SmoothScroll","link","_this7","animation","attr","slice","target","go","scrollY","documentElement","scrollTop","_this8","anime","targets","body","getCurrentPosition","duration","easing","autoplay","complete","restart","e","tag","createElement","src","firstScriptTag","getElementsByTagName","parentNode","insertBefore","reduce","acc","cur","loop","direction","delay"],"mappings":"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","file":"main.js","sourcesContent":["class VidePlayer {\n  constructor(frame, toggler, timeline = 500) {\n    this.frame = frame;\n    this.toggler = toggler;\n    this.timeline = 500;\n\n    this.loaded = false;\n    this.busy = false;\n\n    this.setState('loading');\n\n    this.frameID = frame.getAttribute('id');\n    if(!this.frameID) throw new Error('VideoPlayer: Specify frame ID');\n  }\n\n  setState(state) {\n    switch (state) {\n      case 'loading':\n        this.state = 'loading';\n        break;\n      case 'pause':\n        this.state = 'pause';\n        break;\n      case 'play':\n        this.state = 'play';\n        break;\n      case 'pausing':\n        this.state = 'pausing';\n        break;\n      case 'playing':\n        this.state = 'playing';\n        break;\n      default:\n        return new Error('VideoPlayer: Wrong State');\n    }\n\n    this.notify();\n\n    return this;\n  }\n\n  notify() {\n    this.frame.dataset.videoPlayerState = this.state;\n    this.toggler.dataset.videoPlayerState = this.state;\n  }\n\n  getState() {\n    return this.state;\n  }\n\n  isState(state) {\n    return this.getState() === state;\n  }\n\n  isBusy() {\n    return !!this.busy;\n  }\n\n  occupy() {\n    this.busy = true;\n  }\n\n  vacate() {\n    this.busy = false;\n  }\n\n  load() {\n    if(this.loaded) return;\n\n    this.loaded = true;\n\n    const onPlayerReady = (ev) => {\n      this.setState('pause');\n\n      this.toggler.addEventListener('click', this.play.bind(true));\n\n      return;\n    };\n\n    const onPlayerStateChange = (ev) => {\n      if(ev.data === YT.PlayerState.PAUSED || ev.data === YT.PlayerState.ENDED) {\n        return this.pause(false);\n      } else if(ev.data === YT.PlayerState.PLAYING) {\n        return this.play(false);\n      }\n\n      return;\n    }\n\n    this.player = new YT.Player(this.frame, {\n      events: {\n        'onReady': onPlayerReady,\n        'onStateChange': onPlayerStateChange\n      }\n    });\n\n    return this;\n  }\n\n  play = (startPlaying, cb = () => {}) => {\n    if(this.isState('play') || this.isBusy() || !this.loaded) return false;\n\n    this.occupy();\n    this.setState('playing');\n\n    if(startPlaying) this.player.playVideo();\n\n    setTimeout(() => {\n      this.setState('play');\n      this.vacate();\n\n\n      return cb();\n    }, this.timeline);\n\n    return this;\n\n    return;\n  }\n\n  pause = (pausePlaying, cb = () => {}) => {\n    if(this.isState('pause') || this.isBusy() || !this.loaded) return false;\n\n    if(pausePlaying) this.player.pauseVideo();\n\n    this.occupy();\n    this.setState('pausing');\n\n    setTimeout(() => {\n      this.setState('pause');\n      this.vacate();\n\n      return cb();\n    }, this.timeline);\n\n    return this;\n\n    return;\n  }\n}\n\nconst playerElements = (() => {\n  let player = document.getElementById('video-player');\n  let toggler = document.getElementById('video-toggler');\n\n  if(!toggler | !player) return undefined;\n\n  return { player, toggler };\n})();\n\nconst player = new VidePlayer(playerElements.player, playerElements.toggler);\n\nfunction onYouTubeIframeAPIReady() {\n  player.load();\n};\n\n\ndocument.addEventListener('DOMContentLoaded', (() => {\n  document.querySelector('html').classList.remove('no-js');\n\n  const pairs = Array.from( document.querySelectorAll('[data-toggle]') ).map(toggler => {\n    const ids = JSON.parse(toggler.dataset.toggle);\n\n    const togglees = ids.map(i => document.getElementById(i));\n\n    return { toggler, togglees };\n  });\n\n  const toggle = (el) => {\n    if(el.dataset.visible == 'true') {\n      el.dataset.visible = false;\n\n      return;\n    }\n\n    el.dataset.visible = true;\n\n    return;\n  }\n\n  pairs.forEach(({ toggler, togglees }) => {\n    toggler.addEventListener('click', (ev) => {\n      ev.preventDefault();\n\n      togglees.forEach(toggle);\n\n      return;\n    });\n  });\n\n  const instruction = document.getElementById('instruction-steps');\n  const prev = document.getElementById('instruction-steps-prev');\n  const next = document.getElementById('instruction-steps-next');\n\n  const options = {\n    simulateTouch: false,\n    observer: true,\n    observeParents: true,\n    navigation: {\n      prevEl: prev,\n      nextEl: next,\n    }\n  }\n\n  const swiper = (() => {\n    return instruction ? new Swiper(instruction, options) : null;\n  })();\n\n  class ModalWindow {\n    constructor(element, lining, timeline = 500) {\n      this.el = element;\n      this.lining = lining;\n      this.timeline = timeline;\n      this.busy = false;\n\n      this.setState('closed');\n    }\n\n    setState(state) {\n      switch (state) {\n        case 'open':\n          this.state = 'open';\n          break;\n        case 'closed':\n          this.state = 'closed';\n          break;\n        case 'opening':\n          this.state = 'opening';\n          break;\n        case 'closing':\n          this.state = 'closing';\n          break;\n        default:\n          return new Error('ModalWindow: Wrong State');\n      }\n\n      this.notify();\n\n      return this;\n    }\n\n    notify() {\n      this.el.dataset.modalState = this.state;\n      this.lining.dataset.modalState = this.state;\n    }\n\n    getState() {\n      return this.state;\n    }\n\n    isState(state) {\n      return this.getState() === state;\n    }\n\n    listener = (ev) => {\n      ev.preventDefault();\n\n      return;\n    }\n\n    open(cb = () => {}) {\n      if(this.isState('open') || this.isBusy()) return false;\n\n      window.addEventListener('touchmove', this.listener);\n      window.addEventListener('wheel', this.listener);\n      this.occupy();\n      this.setState('opening');\n\n      setTimeout(() => {\n        this.setState('open');\n        this.vacate();\n\n        return cb();\n      }, this.timeline);\n\n      return this;\n    }\n\n    close(cb = () => {}) {\n      if(this.isState('closed') || this.isBusy()) return false;\n\n      this.occupy();\n      this.setState('closing');\n\n      setTimeout(() => {\n        this.setState('closed');\n        this.vacate();\n\n        window.removeEventListener('touchmove', this.listener);\n        window.removeEventListener('wheel', this.listener);\n\n        return cb();\n      }, this.timeline);\n\n      return this;\n    }\n\n    isBusy() {\n      return !!this.busy;\n    }\n\n    occupy() {\n      this.busy = true;\n    }\n\n    vacate() {\n      this.busy = false;\n    }\n  }\n\n  const lining = document.getElementById('lining');\n\n  const modals = Array.from( document.querySelectorAll('[data-modal-toggler]') ).map(el => {\n    const id = el.dataset.modalToggler;\n    const modal = document.getElementById(id);\n\n    return modal ? { toggler: el, modal: new ModalWindow(modal, lining) } : null;\n  });\n\n  modals.forEach(({ toggler, modal }) => {\n    const listener = (ev) => {\n      ev.preventDefault();\n\n      toggler.removeEventListener('click', listener);\n\n      modal.open(() => {\n        lining.addEventListener('click', liningListener);\n\n        return;\n      });\n\n    }\n\n    const liningListener = (ev) => {\n      ev.preventDefault();\n\n      lining.removeEventListener('click', liningListener);\n\n      modal.close(() => {\n        toggler.addEventListener('click', listener);\n\n        return;\n      })\n    }\n\n    toggler.addEventListener('click', listener);\n  });\n\n  class CubeImage {\n    constructor(el, openTime = 500) {\n      this.el = el;\n      this.openTime = openTime;\n\n      this.vacate();\n\n      this.setState('closed');\n    }\n\n    setState(state) {\n      switch (state) {\n        case 'open':\n          this.state = 'open';\n          break;\n        case 'closed':\n          this.state = 'closed';\n          break;\n        case 'opening':\n          this.state = 'opening';\n          break;\n        case 'closing':\n          this.state = 'closing';\n          break;\n        default:\n          return new Error('ModalWindow: Wrong State');\n      }\n\n      this.notify();\n\n      return this;\n    }\n\n    notify() {\n      this.el.dataset.animationProcess = this.state;\n    }\n\n    getState() {\n      return this.state;\n    }\n\n    isState(state) {\n      return this.getState() === state;\n    }\n\n    open(cb = () => {}) {\n      if(this.isState('open') || this.isBusy()) return false;\n\n      this.occupy();\n      this.setState('opening');\n\n      setTimeout(() => {\n        this.setState('open');\n        this.vacate();\n\n        return cb();\n      }, this.openTime);\n\n      return this;\n    }\n\n    close(cb = () => {}) {\n      if(this.isState('closed') || this.isBusy()) return false;\n\n      this.occupy();\n      this.setState('closing');\n\n      setTimeout(() => {\n        this.setState('closed');\n        this.vacate();\n\n        return cb();\n      }, this.openTime);\n\n      return this;\n    }\n\n    isBusy() {\n      return !!this.busy;\n    }\n\n    occupy() {\n      this.busy = true;\n    }\n\n    vacate() {\n      this.busy = false;\n    }\n  }\n\n  const cubeEl = document.querySelector('[data-animation-process]');\n  const cube = new CubeImage(cubeEl);\n\n  const getCubePosition = (top, height) => {\n    const bottom = top + height;\n    const outTop = (top + height * 0.1) < 0;\n    const outBottom = (top + height * 0.9) - window.innerHeight > 0;\n\n    if(outTop || outBottom) {\n      return 'out';\n    } else {\n      return 'in';\n    }\n  }\n\n  const changeCubeState = (ev) => {\n    const { top, height } = cubeEl.getBoundingClientRect();\n\n    window.removeEventListener('scroll', changeCubeState);\n\n    if(cube.isState('closed') && getCubePosition(top, height) === 'in') {\n      cube.open(() => {\n        changeCubeState();\n      });\n\n      return;\n    } else if(cube.isState('open') && getCubePosition(top, height) === 'out') {\n      cube.close(() => {\n        changeCubeState();\n      });\n\n      return;\n    }\n\n    window.addEventListener('scroll', changeCubeState);\n\n    return;\n  }\n\n  changeCubeState();\n\n  class SmoothScroll {\n    constructor(link) {\n      this.link = link;\n\n      const attr = this.link.getAttribute('href');\n\n      if(!attr || attr.slice(0, 1) !== '#') throw new Error('SmoothScroll: Wrong element passed');\n\n      this.target = document.getElementById( attr.slice(1) );\n\n      this.link.addEventListener('click', (ev) => {\n        ev.preventDefault();\n\n        this.go();\n      });\n    }\n\n    getCurrentPosition() {\n      return this.target ? (window.scrollY || document.documentElement.scrollTop) + this.target.getBoundingClientRect().top : 0;\n    }\n\n    go() {\n      this.animation = anime({\n        targets: [document.body, document.documentElement],\n        scrollTop: this.getCurrentPosition(),\n        duration: 600,\n        easing: \"easeInOutQuart\",\n        autoplay: false,\n        complete: () => {\n          window.removeEventListener(\"wheel\", this.pause);\n          window.removeEventListener(\"touchstart\", this.pause);\n        }\n      });\n\n      window.addEventListener(\"wheel\", this.pause);\n      window.addEventListener(\"touchstart\", this.pause);\n\n      this.animation.restart();\n\n      return;\n    }\n\n    pause = () => {\n      this.animation.pause();\n\n      this.animation = null;\n\n      window.removeEventListener(\"wheel\", this.pause);\n      window.removeEventListener(\"touchstart\", this.pause);\n\n      return;\n    }\n  }\n\n  const links = Array.from( document.querySelectorAll('[data-smooth-scroll]') )\n    .forEach(e => new SmoothScroll(e));\n\n  (function() {\n    if(!player) return;\n\n    const tag = document.createElement('script');\n    tag.src = '//www.youtube.com/iframe_api';\n\n    const firstScriptTag = document.getElementsByTagName('script')[0];\n    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n\n    return;\n  }());\n\n  const icons = Array.from( document.querySelectorAll('[data-levitate]') ).reduce((acc, cur) => {\n    setTimeout(() => {\n      anime({\n        targets: cur,\n        top: ['10px', '-10px'],\n        loop: true,\n        direction: 'alternate',\n        easing: 'easeInOutCubic',\n        duration: 1000,\n        delay: 0\n      });\n\n      return;\n    }, acc);\n\n    return acc + 200;\n  }, 0);\n\n\n}), false);\n"]}